#!/usr/bin/env node

/**
 * Inspired heavily by express 3
 */
var program = require('commander'),
	pkg = require('../package.json'),
	eol = require('../lib/cli/util').eol;

// Usage information
var CREATE_DESC = [
	'create an empty node webapp',
	'',
	'\t$ webcore create ~/webapps/MySampleApp',
	''
].join(eol);

var UPGRADE_DESC = [
	'upgrade an existing webcore application to the latest version of webcore',
	'',
	'\t$ webcore upgrade ~/webapps/MySampleApp',
	''
].join(eol);

var BUILD_DESC = [
	'build a webcore application',
	'',
	'\t$ webcore build ~/webapps/MySampleApp',
	''
].join(eol);

var GENERATE_DESC = [
	'(NOTE: Run this command from the root directory of your node-webcore app.)',
	'Use a generator to create the desired item: \'controller,\' \'model\', or \'template\'.',
	'',
	'\t$ cd ~/webapps/MySampleApp',
	'\t$ webcore generate controller /foo',
	'\t$ webcore generate model foo',
	'\t$ webcore generate template foo'
].join(eol);

var LINT_DESC = [
	'Lint an existing webcore application.',
	'',
	'\tOptions:',
	'\t  -a, --all\tEquivalent to -cs',
	'\t  -c, --client\tLint client JavaScript (default)',
	'\t  -s, --server\tLint server JavaScript',
	'\t  -v, --verbose\tView additional lint information',
	'',
	'\t$ webcore lint ~/webapps/MySampleApp',
].join(eol);

// CLI
program.version(pkg.version);

program
	.command('create <dir>')
	.description(CREATE_DESC)
	.action(require('../lib/cli/create'));

program
	.command('upgrade <dir>')
	.description(UPGRADE_DESC)
	.action(require('../lib/cli/upgrade'));

program
	.command('build <dir>')
	.description(BUILD_DESC)
	.action(require('../lib/cli/build'));

program
	.command('generate <generator> <name>')
	.description(GENERATE_DESC)
	.action(require('../lib/cli/generate'));

program
	.command('lint [<dir>]')
	.option('-a, --all', 'equivalent to --client --server')
	.option('-c, --client', 'lint client JavaScript (default)')
	.option('-s, --server', 'lint server JavaScript')
	.option('-v, --verbose', 'View additional lint information')
	.description(LINT_DESC)
	.action(require('../lib/cli/lint'));

//program
//	.command('*')
//	.description('create an empty node webapp')
//	.action(require('../lib/cli/create'));

program.parse(process.argv);
