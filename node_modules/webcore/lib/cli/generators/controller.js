var path = require('path'),
	cliUtil = require('../util');

var CONTROLLER_TEMPLATE = [
	'/*global exports:true */ // See: https://github.com/jshint/jshint/issues/480',
	'exports = module.exports = function(server) {',
	'/*global exports:false */',
	'	\'use strict\';',
	'',
	'	/**',
	'	 * TODO: Add description',
	'	 * @param {Object} req the HTTP request object',
	'	 * @param {Object} res the HTTP response object',
	'	 */',
	'	server.get(\'/{route}\', function(req, res) {',
	'		// TODO: Implement',
	'		res.send(200, \'\');',
	'	});',
	'',
	'};'
].join(cliUtil.eol);

module.exports = {

	generate: function(name) {
		var directory = null,
			filename = null,
			destination = null;

		if (name.indexOf('/') === 0) {
			name = name.substring(1);
		}

		directory = name.split('/');
		directory = [process.cwd(), 'mvc', 'controller'].concat(directory);
		filename = directory.pop();
		destination = path.join.apply(null, directory);

		cliUtil.mkdir(destination, function(dir) {
			var dest = path.join(dir, filename + '.js');
			cliUtil.write(dest, CONTROLLER_TEMPLATE.replace(/\{route\}/g, name));
		});

	}

};
